{% extends 'base.html' %}{% load i18n %}{% block content %}

<section class="section section-cart-page">
	<div class="container">
		<h2>{% translate "Your Cart" %}</h2>

		{% if cart_items %}

		<table>
			<thead>
				<tr>
					<th>{% translate "Product" %}</th>
					<th>{% translate "Unit" %}</th>
					<th>{% translate "Qty" %}</th>
					<th>{% translate "Line" %}</th>
				</tr>
			</thead>
			<tbody>
				{% for item in cart_items %}
				<tr>
					<td>
						<a href="{% url 'shop:product' item.product.id %}">
							<img src="{{ item.product.image.url }}" alt="" />
							{{ item.product.name }}
						</a>
					</td>
					<td>{{ item.unit_dollars }}</td>

					<td>
						<form
							method="post"
							action="{% url 'cart:update_cart' item.product.id %}"
						>
							{% csrf_token %}
							<input
								type="number"
								name="quantity"
								value="{{ item.quantity }}"
								min="1"
								max="{{ item.product.quantity }}"
							/>
							<button type="submit" class="btn btn--secondary btn--sm">
								{% translate "Update" %}
							</button>
						</form>
					</td>

					<td>{{ item.line_dollars }}</td>

					<td>
						<form
							method="post"
							action="{% url 'cart:remove_from_cart' item.product.id %}"
						>
							{% csrf_token %}
							<button type="submit" class="btn btn--warning btn--sm">
								{% translate "Remove" %}
							</button>
						</form>
					</td>
				</tr>
				{% endfor %}
			</tbody>

			<tfoot>
				<tr>
					<td colspan="3"><strong>{% translate "Total" %}</strong></td>
					<td><strong>{{ subtotal_dollars }}</strong></td>
					<td></td>
				</tr>
			</tfoot>
		</table>

		<div class="cart-footer-buttons">
			<form method="post" action="{% url 'cart:clear_cart' %}">
				{% csrf_token %}
				<button type="submit" class="btn">{% translate "Clear Cart" %}</button>
			</form>

			<a href="{% url 'cart:checkout' %}" class="btn btn--cta">
				{% translate "Checkout" %}
			</a>
		</div>

		{% else %}
		<p>{% translate "Your cart is empty." %}</p>

		<a href="{% url 'shop:shop' %}" class="btn btn--primary">
			{% translate "Continue Shopping" %}
		</a>
		{% endif %}
	</div>

	{% endblock %}
</section>
